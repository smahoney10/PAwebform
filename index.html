<!DOCTYPE html> 
<html> 
<head>
    <title>Prior Authorization Item Webform</title>
    <link href='http://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'>
<style type="text/css">
.form-style-10{
	width:450px;
	padding:30px;
	margin:40px auto;
	background: #FFF;
	border-radius: 10px;
	-webkit-border-radius:10px;
	-moz-border-radius: 10px;
	box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.13);
	-moz-box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.13);
	-webkit-box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.13);
}
.form-style-10 .inner-wrap{
	padding: 30px;
	background: #F8F8F8;
	border-radius: 6px;
	margin-bottom: 15px;
}
.form-style-10 h1{
	background: #2A88AD;
	padding: 20px 30px 15px 30px;
	margin: -30px -30px 30px -30px;
	border-radius: 10px 10px 0 0;
	-webkit-border-radius: 10px 10px 0 0;
	-moz-border-radius: 10px 10px 0 0;
	color: #fff;
	text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.12);
	font: normal 30px 'Bitter', serif;
	-moz-box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.17);
	-webkit-box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.17);
	box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.17);
	border: 1px solid #257C9E;
}
.form-style-10 h1 > span{
	display: block;
	margin-top: 2px;
	font: 13px Arial, Helvetica, sans-serif;
}
.form-style-10 label{
	display: block;
	font: 13px Arial, Helvetica, sans-serif;
	color: #888;
	margin-bottom: 15px;
}
.form-style-10 input[type="text"],
.form-style-10 input[type="date"],
.form-style-10 input[type="datetime"],
.form-style-10 input[type="email"],
.form-style-10 input[type="number"],
.form-style-10 input[type="search"],
.form-style-10 input[type="time"],
.form-style-10 input[type="url"],
.form-style-10 input[type="password"],
.form-style-10 textarea,
.form-style-10 select {
	display: block;
	box-sizing: border-box;
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	width: 100%;
	padding: 8px;
	border-radius: 6px;
	-webkit-border-radius:6px;
	-moz-border-radius:6px;
	border: 2px solid #fff;
	box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.33);
	-moz-box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.33);
	-webkit-box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.33);
}

.form-style-10 .section{
	font: normal 20px 'Bitter', serif;
	color: #2A88AD;
	margin-bottom: 5px;
}
.form-style-10 .section span {
	background: #2A88AD;
	padding: 5px 10px 5px 10px;
	position: absolute;
	border-radius: 50%;
	-webkit-border-radius: 50%;
	-moz-border-radius: 50%;
	border: 4px solid #fff;
	font-size: 14px;
	margin-left: -45px;
	color: #fff;
	margin-top: -3px;
}
.form-style-10 input[type="button"], 
.form-style-10 input[type="submit"]{
	background: #2A88AD;
	padding: 8px 20px 8px 20px;
	border-radius: 5px;
	-webkit-border-radius: 5px;
	-moz-border-radius: 5px;
	color: #fff;
	text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.12);
	font: normal 30px 'Bitter', serif;
	-moz-box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.17);
	-webkit-box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.17);
	box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.17);
	border: 1px solid #257C9E;
	font-size: 15px;
}
.form-style-10 input[type="button"]:hover, 
.form-style-10 input[type="submit"]:hover{
	background: #2A6881;
	-moz-box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.28);
	-webkit-box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.28);
	box-shadow: inset 0px 2px 2px 0px rgba(255, 255, 255, 0.28);
}
.form-style-10 .privacy-policy{
	float: right;
	width: 250px;
	font: 12px Arial, Helvetica, sans-serif;
	color: #4D4D4D;
	margin-top: 10px;
	text-align: right;
}
</style>


    
     <script>
       // import { uuidv7 } from 'uuidv7';
        const existingIDs = ['AA1111','XY1234'];
        const getRandomLetters = (length = 1) => Array(length).fill().map(e => String.fromCharCode(Math.floor(Math.random() * 26) + 65)).join('');
        const getRandomDigits = (length = 1) => Array(length).fill().map(e => Math.floor(Math.random() * 10)).join('');
        const generateUniqueID = () => {
        let id = getRandomLetters(2) + getRandomDigits(4);
        while (existingIDs.includes(id)) id = getRandomLetters(2) + getRandomDigits(4);
        return id;
        };

        function getvalues(x){
            var y = 'ruleKey' + x
            var z = 'ruleValue' + x
            var ruleKey = document.getElementById(y).value;
            var ruleValue = document.getElementById(z).value;
                if (/^\s*$/.test(ruleKey)){
                //value is either empty or contains whitespace characters
                //do not append the value
                return ""
                }
                else{
                    var rule = ",[" + ruleKey + "]:" + ruleValue
                    return rule
                //code for appending the value to url
                }
        }
        function getRuleKey(x){
            var y = 'ruleKey' + x
            var ruleKey = document.getElementById(y).value;
                if (/^\s*$/.test(ruleKey)){
                //value is either empty or contains whitespace characters
                //do not append the value
                return ""
                }
                else{
                    //var rule = ",[" + ruleKey + "]:" 
                    var rule =  ruleKey
                    return rule
                //code for appending the value to url
                }
        }
        function getRuleValue(x){
            var z = 'ruleValue' + x
            var ruleValue = document.getElementById(z).value;
                if (/^\s*$/.test(ruleValue)){
                //value is either empty or contains whitespace characters
                //do not append the value
                return ""
                }
                else{
                    var rule =  ruleValue
                    return rule
                //code for appending the value to url
                }
        }

        function outputPAJson() {
            var newID = uuidv4();
            var ruleName = document.getElementById('ruleName').value;
            var ruleType = document.getElementById('ruleType').value;
            var ruleDesc = document.getElementById('ruleDesc').value;
            var ruleKey1 = getRuleKey(1)
            var ruleValue1 = getRuleValue(1)
            var ruleKey2 = getRuleKey(2)
            var ruleValue2 = getRuleValue(2)
            var ruleKey3 = getRuleKey(3)
            var ruleValue3 = getRuleValue(3)
            var ruleKey4 = getRuleKey(4)
            var ruleValue4 = getRuleValue(4)
            /*var rule2 = getvalue(2)
            var rule3 = getvalue(3)
            var rule4 = getvalue(4)
            var rules = rule1 + rule2 + rule3 + rule4*/
            var codeSystem = document.getElementById('codeSystem').value;
            var code = document.getElementById('code').value;
            var display = document.getElementById('display').value;
            var text = document.getElementById('text').value
            var data = 
                    {
            "PayerRuleId": newID,
            "RuleName": ruleName,
            "RuleType": ruleType,
            "RuleDescription": ruleDesc,
            [ruleKey1]: ruleValue1,
            [ruleKey2]: ruleValue2,
            [ruleKey3]: ruleValue3,
            [ruleKey4]: ruleValue4
            ,"ServiceRequestCodes": [
                {
                    "System": codeSystem,
                    "Code": code,
                    "Display": display,
                    "Text": text
                }
                ]
            };
            
            document.getElementById('Traveleroutput').innerHTML = JSON.stringify(data, null, 2);
            
            document.getElementById('nextStep').innerHTML = "JSON generated below. ";
            //sendToCDC();
            return false;
        }
        function uuidv4() {
        return "10000000-1000-4000-8000-100000000000".replace(/[018]/g, c =>
            (+c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> +c / 4).toString(16)
        );
        }
        function getUUID()
        {
            const apiUrl = 'https://www.uuidgenerator.net/api/version4';

            const outputElement = document.getElementById('output');
           fetch("https://www.uuidgenerator.net/api/version4", {
                method: "GET",
                headers: {
                    "Content-type": "text/plain; charset=utf-8"
                }
            })
            .then((response) => response.json())
            .then((json) => console.log(json))
            
       }
            </script>
</head>
<body>
    <h1>Payer PA Criteria</h1>
    <form onsubmit="return outputPAJson()" id="jsonForm">
    
    <div class="section"><span>1</span>Rule Information</div>
        <div class="inner-wrap">
          <label label id="nextStep">Rule Type</label>
            <select name="ruleType" id="ruleType" class="field-select">
                <option value="Questionaire">Questionaire</option>
                <option value="PDF">PDF</option>
                <option value="Demographic">Demographic</option>
                <option value="Other">Other</option>
            </select>
          <label label id="nextStep">Rule Name</label>
            <input type="text" id="ruleName" name="ruleName" class="field-long" />
            <label label id="nextStep">Rule Description</label>
            <input type="text" id="ruleDesc" name="ruleDesc" class="field-long" />
        </div>
        <h4>Conditions</h4>

        <label>Condition 1</label>
        Condition: 
        <select name="ruleKey1" id="ruleKey1" class="field-select">
            <option disabled selected value> -- select a rule -- </option>
            <option value="minAge">Minimum Age</option>
            <option value="Gender">Gender</option>
            <option value="ServiceDate">Service Date</option>
            <option value="ProviderType">Provider Type</option>
            <option value="Other">Other</option>
        </select>
        Condition Value: <input id="ruleValue1" name="ruleValue1" class="field-long" />
        
        <label>Condition 2</label>
        Condition: 
        <select name="ruleKey2" id="ruleKey2" class="field-select">
            <option disabled selected value> -- select a rule -- </option>
            <option value="minAge">Minimum Age</option>
            <option value="Gender">Gender</option>
            <option value="ServiceDate">Service Date</option>
            <option value="ProviderType">Provider Type</option>
            <option value="Other">Other</option>
        </select>        
        Condition Value: <input id="ruleValue2" name="ruleValue2" class="field-long" />
        
        <label>Condition 3</label>
        Condition Key: 
        <select name="ruleKey3" id="ruleKey3" class="field-select">
            <option disabled selected value> -- select a rule -- </option>
            <option value="minAge">Minimum Age</option>
            <option value="Gender">Gender</option>
            <option value="ServiceDate">Service Date</option>
            <option value="ProviderType">Provider Type</option>
            <option value="Other">Other</option>
        </select>
        Condition Value: <input id="ruleValue3" name="ruleValue3" class="field-long" />
        
        <label>Condition 4</label>
        New Condition: <input id="ruleKey4" name="ruleKey4" class="field-long" />
        New Condition Value: <input id="ruleValue4" name="ruleValue4" class="field-long" />
        
        
        <label>Service Request Codes</label>
        Coding System: <br>
        <select name="codeSystem" id="codeSystem">
            <option value="SNOMED"> SNOMED</option>
            <option value="ICD-10"> ICD-10</option>
            <option value="LOINC">LOINC</option>
        </select><br>    
        Code: <br> <input type="text" id="code" class="field-long"><br>
        Display: <br> <input type="text" id="display" class="field-long"><br>
        Text: <br> <input type="text" id="text" class="field-long"><br>
        
        <li>
            <input type="submit" value="Submit" />
        </li>
    </ul>
    </form>
    <p id="result">     </p> 
    <li><label id="output"></label></li>
    <pre id="Traveleroutput"></pre>
    <pre id="APIoutput"></pre>
        
            
        <p id="result">     </p> 
        <pre id="travelerCreated"></pre>
    </body>
</html>